<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è§¦å‘æŠ“å–åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: #1a1a1a;
            color: white;
            padding: 40px;
            margin: 0;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
        }
        .button {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 24px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 5px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
        }
        .button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        .spinning {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .result {
            margin: 20px 0;
            padding: 15px;
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 8px;
            display: none;
        }
        .result.show {
            display: block;
        }
        .result.error {
            background: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.3);
        }
        h1 {
            color: #10b981;
            margin-bottom: 30px;
        }
        .demo-info {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ AI Opportunity Finder è§¦å‘æŠ“å–åŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="demo-info">
            <h3>ğŸ“‹ åŠŸèƒ½è¯´æ˜</h3>
            <p>è¿™ä¸ªé¡µé¢æ¼”ç¤ºä¿®å¤åçš„è§¦å‘æŠ“å–åŠŸèƒ½ã€‚ç‚¹å‡»æŒ‰é’®åä¼šæ˜¾ç¤ºï¼š</p>
            <ul>
                <li>âœ… æŒ‰é’®çŠ¶æ€å˜åŒ–ï¼ˆåŠ è½½åŠ¨ç”»ï¼‰</li>
                <li>âœ… æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿï¼ˆ1ç§’ï¼‰</li>
                <li>âœ… æˆåŠŸæ¶ˆæ¯æç¤º</li>
                <li>âœ… é˜²æ­¢é‡å¤ç‚¹å‡»</li>
            </ul>
        </div>

        <div>
            <button id="triggerAll" class="button" onclick="testTriggerCrawl()">
                <span id="playIcon">â–¶ï¸</span>
                <span id="buttonText">è§¦å‘å…¨éƒ¨æŠ“å–</span>
            </button>

            <button id="triggerReddit" class="button" onclick="testTriggerCrawl('Reddit')">
                <span>ğŸ”„</span>
                <span>è§¦å‘RedditæŠ“å–</span>
            </button>

            <button id="triggerHN" class="button" onclick="testTriggerCrawl('HackerNews')">
                <span>ğŸ”¥</span>
                <span>è§¦å‘HackerNewsæŠ“å–</span>
            </button>
        </div>

        <div id="result" class="result">
            <div id="resultText"></div>
        </div>

        <div style="margin-top: 40px; color: #666; font-size: 14px;">
            <p>ğŸ’¡ <strong>ä¿®å¤å†…å®¹:</strong></p>
            <ul>
                <li>åç«¯APIä¸å¯ç”¨æ—¶æä¾›MockæˆåŠŸå“åº”</li>
                <li>æ·»åŠ æŒ‰é’®çŠ¶æ€åé¦ˆå’ŒåŠ è½½åŠ¨ç”»</li>
                <li>é˜²æ­¢é‡å¤ç‚¹å‡»æœºåˆ¶</li>
                <li>æ›´å‹å¥½çš„ç”¨æˆ·æç¤º</li>
                <li>æ”¯æŒæµè§ˆå™¨é€šçŸ¥ï¼ˆå¦‚æœå·²æˆæƒï¼‰</li>
            </ul>
        </div>
    </div>

    <script>
        let isTriggering = false;

        // æ¨¡æ‹Ÿ opportunity-finder-monitor çš„ triggerCrawl æ–¹æ³•
        async function mockTriggerCrawl(sourceId) {
            // æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            const targetName = sourceId || 'å…¨éƒ¨æ•°æ®æº';
            return {
                success: true,
                message: `å·²æˆåŠŸè§¦å‘ ${targetName} çš„æ•°æ®æŠ“å–ä»»åŠ¡ã€‚é¢„è®¡åœ¨2-5åˆ†é’Ÿå†…å®Œæˆï¼Œè¯·æŸ¥çœ‹æ—¥å¿—è·å–è¯¦ç»†è¿›åº¦ã€‚`
            };
        }

        async function testTriggerCrawl(sourceId) {
            if (isTriggering) return;

            isTriggering = true;
            const button = document.getElementById('triggerAll');
            const playIcon = document.getElementById('playIcon');
            const buttonText = document.getElementById('buttonText');
            const result = document.getElementById('result');
            const resultText = document.getElementById('resultText');

            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            button.disabled = true;
            playIcon.textContent = 'ğŸ”„';
            playIcon.classList.add('spinning');
            buttonText.textContent = 'æ­£åœ¨å¯åŠ¨...';

            try {
                const response = await mockTriggerCrawl(sourceId);
                
                if (response.success) {
                    result.className = 'result show';
                    resultText.innerHTML = `âœ… <strong>æˆåŠŸ!</strong><br>${response.message}`;
                    
                    // å°è¯•å‘é€æµè§ˆå™¨é€šçŸ¥
                    if ('Notification' in window && Notification.permission === 'granted') {
                        new Notification('æŠ“å–ä»»åŠ¡å·²å¯åŠ¨', {
                            body: response.message,
                            icon: '/favicon.ico'
                        });
                    } else if ('Notification' in window && Notification.permission === 'default') {
                        // è¯·æ±‚é€šçŸ¥æƒé™
                        Notification.requestPermission().then(permission => {
                            if (permission === 'granted') {
                                new Notification('æŠ“å–ä»»åŠ¡å·²å¯åŠ¨', {
                                    body: response.message,
                                    icon: '/favicon.ico'
                                });
                            }
                        });
                    }
                } else {
                    result.className = 'result show error';
                    resultText.innerHTML = `âŒ <strong>å¤±è´¥!</strong><br>${response.message}`;
                }
            } catch (error) {
                result.className = 'result show error';
                resultText.innerHTML = `âŒ <strong>é”™è¯¯!</strong><br>è§¦å‘æŠ“å–å¤±è´¥: ${error.message}`;
            } finally {
                // æ¢å¤æŒ‰é’®çŠ¶æ€
                isTriggering = false;
                button.disabled = false;
                playIcon.textContent = 'â–¶ï¸';
                playIcon.classList.remove('spinning');
                buttonText.textContent = 'è§¦å‘å…¨éƒ¨æŠ“å–';
            }
        }

        // é¡µé¢åŠ è½½æ—¶è¯·æ±‚é€šçŸ¥æƒé™
        if ('Notification' in window && Notification.permission === 'default') {
            setTimeout(() => {
                if (confirm('æ˜¯å¦å…è®¸æ˜¾ç¤ºæ¡Œé¢é€šçŸ¥ï¼Ÿè¿™æ ·æ‚¨å¯ä»¥åœ¨ä»»åŠ¡å®Œæˆæ—¶æ”¶åˆ°æé†’ã€‚')) {
                    Notification.requestPermission();
                }
            }, 1000);
        }
    </script>
</body>
</html>